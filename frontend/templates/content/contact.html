{% extends 'base.html' %}
{% load static %}

{% block title %}Contact Us - Packaxis Packaging Canada{% endblock %}

{% block meta_description %}Get in touch with Packaxis. We're here to help with your packaging needs. Contact us for quotes, support, or partnership inquiries.{% endblock %}

{% block content %}
<!-- Breadcrumb Navigation -->
<nav class="breadcrumb-nav" aria-label="Breadcrumb">
  <div class="container">
    <ol class="breadcrumb-list">
      <li class="breadcrumb-item">
        <a href="{% url 'home' %}" class="breadcrumb-link">Home</a>
      </li>
      <li class="breadcrumb-separator" aria-hidden="true">
        <span class="material-symbols-rounded">chevron_right</span>
      </li>
      <li class="breadcrumb-item breadcrumb-item--current">
        <span aria-current="page">Contact</span>
      </li>
    </ol>
  </div>
</nav>

<!-- Contact Hero Section -->
<section class="contact-hero">
  <div class="contact-hero__bg">
    <div class="contact-hero__gradient"></div>
    <div class="contact-hero__pattern"></div>
  </div>
  <div class="container">
    <div class="contact-hero__content">
      <span class="contact-hero__badge">
        <span class="material-symbols-rounded">chat</span>
        Get In Touch
      </span>
      <h1 class="contact-hero__title">Let's Start a <span class="text-accent">Conversation</span></h1>
      <p class="contact-hero__subtitle">Have questions about our packaging solutions? We're here to help you find the perfect fit for your business.</p>
    </div>
  </div>
</section>

<!-- Contact Main Section -->
<section class="contact-main">
  <div class="container">
    <div class="contact-grid">
      <!-- Contact Form -->
      <div class="contact-form-wrapper">
        <div class="contact-form-card">
          <div class="contact-form-header">
            <h2 class="contact-form-title">Send Us a Message</h2>
            <p class="contact-form-description">Fill out the form below and our team will get back to you within 24 hours.</p>
          </div>
          
          <form id="contact-form" class="contact-form" novalidate>
            {% csrf_token %}
            
            <div class="form-row">
              <div class="form-group">
                <label for="first_name" class="form-label">
                  First Name <span class="required">*</span>
                </label>
                <div class="form-input-wrapper">
                  <span class="material-symbols-rounded form-icon">person</span>
                  <input type="text" id="first_name" name="first_name" class="form-input" placeholder="John" required>
                </div>
                <span class="form-error" id="first_name-error"></span>
              </div>
              
              <div class="form-group">
                <label for="last_name" class="form-label">
                  Last Name <span class="required">*</span>
                </label>
                <div class="form-input-wrapper">
                  <span class="material-symbols-rounded form-icon">badge</span>
                  <input type="text" id="last_name" name="last_name" class="form-input" placeholder="Doe" required>
                </div>
                <span class="form-error" id="last_name-error"></span>
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <label for="email" class="form-label">
                  Email Address <span class="required">*</span>
                </label>
                <div class="form-input-wrapper">
                  <span class="material-symbols-rounded form-icon">mail</span>
                  <input type="email" id="email" name="email" class="form-input" placeholder="john@company.com" required>
                </div>
                <span class="form-error" id="email-error"></span>
              </div>
              
              <div class="form-group">
                <label for="phone" class="form-label">
                  Phone Number
                </label>
                <div class="form-input-wrapper">
                  <span class="material-symbols-rounded form-icon">phone</span>
                  <input type="tel" id="phone" name="phone" class="form-input" placeholder="+1 (555) 000-0000">
                </div>
                <span class="form-error" id="phone-error"></span>
              </div>
            </div>
            
            <div class="form-group">
              <label for="company" class="form-label">
                Company Name
              </label>
              <div class="form-input-wrapper">
                <span class="material-symbols-rounded form-icon">business</span>
                <input type="text" id="company" name="company" class="form-input" placeholder="Your Company Ltd.">
              </div>
            </div>
            
            <div class="form-group">
              <label for="subject" class="form-label">
                Subject <span class="required">*</span>
              </label>
              <div class="form-select-wrapper">
                <span class="material-symbols-rounded form-icon">topic</span>
                <select id="subject" name="subject" class="form-select" required>
                  <option value="">Select a topic...</option>
                  <option value="quote">Request a Quote</option>
                  <option value="product">Product Inquiry</option>
                  <option value="order">Order Status</option>
                  <option value="custom">Custom Packaging</option>
                  <option value="wholesale">Wholesale Partnership</option>
                  <option value="support">Technical Support</option>
                  <option value="feedback">Feedback</option>
                  <option value="other">Other</option>
                </select>
                <span class="material-symbols-rounded form-select-arrow">expand_more</span>
              </div>
              <span class="form-error" id="subject-error"></span>
            </div>
            
            <div class="form-group">
              <label for="message" class="form-label">
                Message <span class="required">*</span>
              </label>
              <div class="form-textarea-wrapper">
                <textarea id="message" name="message" class="form-textarea" rows="5" placeholder="Tell us about your packaging needs, expected quantities, timeline, or any other details that would help us serve you better..." required></textarea>
              </div>
              <span class="form-error" id="message-error"></span>
              <span class="form-hint">Minimum 20 characters</span>
            </div>
            
            <div class="form-group form-checkbox-group">
              <label class="form-checkbox-label">
                <input type="checkbox" id="newsletter" name="newsletter" class="form-checkbox">
                <span class="form-checkbox-custom"></span>
                <span class="form-checkbox-text">Subscribe to our newsletter for packaging tips and exclusive offers</span>
              </label>
            </div>
            
            <button type="submit" class="contact-submit-btn">
              <span class="btn-text">Send Message</span>
              <span class="material-symbols-rounded btn-icon">send</span>
              <span class="btn-loader">
                <span class="loader-dot"></span>
                <span class="loader-dot"></span>
                <span class="loader-dot"></span>
              </span>
            </button>
          </form>
          
          <!-- Success Message -->
          <div id="contact-success" class="contact-success" style="display: none;">
            <div class="contact-success__icon">
              <span class="material-symbols-rounded">check_circle</span>
            </div>
            <h3 class="contact-success__title">Message Sent Successfully!</h3>
            <p class="contact-success__text">Thank you for reaching out. Our team will review your message and get back to you within 24 hours.</p>
            <button type="button" class="contact-success__btn" onclick="resetContactForm()">
              <span class="material-symbols-rounded">refresh</span>
              Send Another Message
            </button>
          </div>
        </div>
      </div>
      
      <!-- Contact Info Sidebar -->
      <div class="contact-info-sidebar">
        <!-- Quick Contact Cards -->
        <div class="contact-info-cards">
          <div class="contact-info-card">
            <div class="contact-info-card__icon">
              <span class="material-symbols-rounded">location_on</span>
            </div>
            <div class="contact-info-card__content">
              <h3 class="contact-info-card__title">Visit Our Office</h3>
              <p class="contact-info-card__text">135 Eighth St<br>Toronto, ON M8V 3C8<br>Canada</p>
              <a href="https://maps.google.com/?q=135+Eighth+St,+Toronto,+ON+M8V+3C8" target="_blank" rel="noopener" class="contact-info-card__link">
                Get Directions
                <span class="material-symbols-rounded">arrow_outward</span>
              </a>
            </div>
          </div>
          
          <div class="contact-info-card">
            <div class="contact-info-card__icon">
              <span class="material-symbols-rounded">phone</span>
            </div>
            <div class="contact-info-card__content">
              <h3 class="contact-info-card__title">Call Us</h3>
              <p class="contact-info-card__text">Toll-Free: <strong>+1 (844) 844-4022</strong><br>Mon-Fri: 9AM - 6PM EST</p>
              <a href="tel:+18448444022" class="contact-info-card__link">
                Call Now
                <span class="material-symbols-rounded">call</span>
              </a>
            </div>
          </div>
          
          <div class="contact-info-card">
            <div class="contact-info-card__icon">
              <span class="material-symbols-rounded">mail</span>
            </div>
            <div class="contact-info-card__content">
              <h3 class="contact-info-card__title">Email Us</h3>
              <p class="contact-info-card__text">Support: <strong>support@packaxis.ca</strong><br>Sales: <strong>sales@packaxis.ca</strong></p>
              <a href="mailto:support@packaxis.ca" class="contact-info-card__link">
                Send Email
                <span class="material-symbols-rounded">forward_to_inbox</span>
              </a>
            </div>
          </div>
        </div>
        
        <!-- Business Hours -->
        <div class="contact-hours-card">
          <div class="contact-hours-header">
            <span class="material-symbols-rounded">schedule</span>
            <h3>Business Hours</h3>
          </div>
          <ul class="contact-hours-list">
            <li class="contact-hours-item">
              <span class="day">Monday - Friday</span>
              <span class="time">9:00 AM - 6:00 PM</span>
            </li>
            <li class="contact-hours-item">
              <span class="day">Saturday</span>
              <span class="time">10:00 AM - 4:00 PM</span>
            </li>
            <li class="contact-hours-item">
              <span class="day">Sunday</span>
              <span class="time closed">Closed</span>
            </li>
          </ul>
          <div class="contact-hours-note">
            <span class="material-symbols-rounded">info</span>
            <span>All times are in Eastern Time (ET)</span>
          </div>
        </div>
        
        <!-- Social Links -->
        <div class="contact-social-card">
          <h3 class="contact-social-title">Connect With Us</h3>
          <p class="contact-social-text">Follow us for packaging tips, industry news, and behind-the-scenes content.</p>
          <div class="contact-social-links">
            <a href="https://www.facebook.com/people/PackAxis-Packaging/61584632132597/" target="_blank" rel="noopener" class="contact-social-link" aria-label="Facebook">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H8v-3h2V9.5C10 7.57 11.57 6 13.5 6H16v3h-2c-.55 0-1 .45-1 1v2h3v3h-3v6.95c5.05-.5 9-4.76 9-9.95z"/></svg>
            </a>
            <a href="https://instagram.com/packaxis" target="_blank" rel="noopener" class="contact-social-link" aria-label="Instagram">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M7.8 2h8.4C19.4 2 22 4.6 22 7.8v8.4a5.8 5.8 0 0 1-5.8 5.8H7.8C4.6 22 2 19.4 2 16.2V7.8A5.8 5.8 0 0 1 7.8 2m-.2 2A3.6 3.6 0 0 0 4 7.6v8.8C4 18.39 5.61 20 7.6 20h8.8a3.6 3.6 0 0 0 3.6-3.6V7.6C20 5.61 18.39 4 16.4 4H7.6m9.65 1.5a1.25 1.25 0 0 1 1.25 1.25A1.25 1.25 0 0 1 17.25 8 1.25 1.25 0 0 1 16 6.75a1.25 1.25 0 0 1 1.25-1.25M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3z"/></svg>
            </a>
            <a href="https://www.linkedin.com/company/packaxis" target="_blank" rel="noopener" class="contact-social-link" aria-label="LinkedIn">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14m-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93h2.79M6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37h2.77z"/></svg>
            </a>
            <a href="https://youtube.com/@packaxis" target="_blank" rel="noopener" class="contact-social-link" aria-label="YouTube">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M10 15l5.19-3L10 9v6m11.56-7.83c.13.47.22 1.1.28 1.9.07.8.1 1.49.1 2.09L22 12c0 2.19-.16 3.8-.44 4.83-.25.9-.83 1.48-1.73 1.73-.47.13-1.33.22-2.65.28-1.3.07-2.49.1-3.59.1L12 19c-4.19 0-6.8-.16-7.83-.44-.9-.25-1.48-.83-1.73-1.73-.13-.47-.22-1.1-.28-1.9-.07-.8-.1-1.49-.1-2.09L2 12c0-2.19.16-3.8.44-4.83.25-.9.83-1.48 1.73-1.73.47-.13 1.33-.22 2.65-.28 1.3-.07 2.49-.1 3.59-.1L12 5c4.19 0 6.8.16 7.83.44.9.25 1.48.83 1.73 1.73z"/></svg>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Map Section -->
<section class="contact-map-section">
  <div class="container">
    <div class="contact-map-wrapper">
      <div class="contact-map-header">
        <h2 class="contact-map-title">Find Us</h2>
        <p class="contact-map-subtitle">Visit our Toronto office for in-person consultations and sample viewing</p>
      </div>
      <div class="contact-map-container">
        <iframe 
          src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2888.0139382534!2d-79.5014!3d43.6161!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x882b35b0b9e8e9e9%3A0x0!2s135%20Eighth%20St%2C%20Toronto%2C%20ON%20M8V%203C8!5e0!3m2!1sen!2sca!4v1234567890"
          width="100%" 
          height="450" 
          style="border:0;" 
          allowfullscreen="" 
          loading="lazy" 
          referrerpolicy="no-referrer-when-downgrade"
          title="Packaxis Office Location">
        </iframe>
      </div>
    </div>
  </div>
</section>

<!-- FAQ Quick Links Section -->
<section class="contact-faq-section">
  <div class="container">
    <div class="contact-faq-wrapper">
      <div class="contact-faq-content">
        <span class="contact-faq-badge">
          <span class="material-symbols-rounded">help</span>
          Quick Help
        </span>
        <h2 class="contact-faq-title">Frequently Asked Questions</h2>
        <p class="contact-faq-text">Find instant answers to common questions about ordering, shipping, customization, and more.</p>
        <a href="/faq/" class="contact-faq-btn">
          <span>Browse FAQ</span>
          <span class="material-symbols-rounded">arrow_forward</span>
        </a>
      </div>
      <div class="contact-faq-cards">
        <a href="/faq/#shipping" class="contact-faq-card">
          <span class="material-symbols-rounded">local_shipping</span>
          <h4>Shipping & Delivery</h4>
          <p>Delivery times, tracking, and free shipping thresholds</p>
        </a>
        <a href="/faq/#orders" class="contact-faq-card">
          <span class="material-symbols-rounded">shopping_bag</span>
          <h4>Orders & Payment</h4>
          <p>Order process, payment methods, and invoicing</p>
        </a>
        <a href="/faq/#custom" class="contact-faq-card">
          <span class="material-symbols-rounded">design_services</span>
          <h4>Custom Packaging</h4>
          <p>Minimum orders, design specs, and lead times</p>
        </a>
        <a href="/faq/#returns" class="contact-faq-card">
          <span class="material-symbols-rounded">autorenew</span>
          <h4>Returns & Refunds</h4>
          <p>Return policy, refund process, and exchanges</p>
        </a>
      </div>
    </div>
  </div>
</section>

<!-- CTA Section -->
<section class="contact-cta-section">
  <div class="container">
    <div class="contact-cta-wrapper">
      <div class="contact-cta-content">
        <h2 class="contact-cta-title">Ready to Get Started?</h2>
        <p class="contact-cta-text">Request a custom quote for your packaging needs and receive competitive wholesale pricing.</p>
      </div>
      <a href="/quote/" class="contact-cta-btn">
        <span>Request a Quote</span>
        <span class="material-symbols-rounded">request_quote</span>
      </a>
    </div>
  </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
  const form = document.getElementById('contact-form');
  const successMsg = document.getElementById('contact-success');
  
  function showError(fieldId, message) {
    const errorEl = document.getElementById(fieldId + '-error');
    const groupEl = document.getElementById(fieldId)?.closest('.form-group');
    if (errorEl) errorEl.textContent = message;
    if (groupEl) groupEl.classList.add('has-error');
  }
  
  function isValidEmail(email) {
    return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
  }
  
  form.addEventListener('submit', async function(e) {
    e.preventDefault();
    
    // Clear previous errors
    document.querySelectorAll('.form-error').forEach(el => el.textContent = '');
    document.querySelectorAll('.form-group').forEach(el => el.classList.remove('has-error'));
    
    // Collect form data
    const formData = {
      first_name: document.getElementById('first_name').value.trim(),
      last_name: document.getElementById('last_name').value.trim(),
      email: document.getElementById('email').value.trim(),
      phone: document.getElementById('phone').value.trim(),
      company: document.getElementById('company').value.trim(),
      subject: document.getElementById('subject').value,
      message: document.getElementById('message').value.trim(),
      newsletter: document.getElementById('newsletter').checked
    };
    
    // Basic validation
    let isValid = true;
    
    if (!formData.first_name) {
      showError('first_name', 'First name is required');
      isValid = false;
    }
    
    if (!formData.last_name) {
      showError('last_name', 'Last name is required');
      isValid = false;
    }
    
    if (!formData.email) {
      showError('email', 'Email is required');
      isValid = false;
    } else if (!isValidEmail(formData.email)) {
      showError('email', 'Please enter a valid email address');
      isValid = false;
    }
    
    if (!formData.subject) {
      showError('subject', 'Please select a subject');
      isValid = false;
    }
    
    if (!formData.message) {
      showError('message', 'Message is required');
      isValid = false;
    } else if (formData.message.length < 20) {
      showError('message', 'Message must be at least 20 characters');
      isValid = false;
    }
    
    if (!isValid) return;
    
    // Show loading state
    const submitBtn = form.querySelector('.contact-submit-btn');
    submitBtn.classList.add('loading');
    submitBtn.disabled = true;
    
    // Send to API endpoint (sends email to support@packaxis.ca)
    try {
      const response = await fetch('/api/communications/contact/submit/', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
        },
        body: JSON.stringify(formData)
      });
      
      const result = await response.json();
      
      if (result.success) {
        // Show success message
        form.style.display = 'none';
        successMsg.style.display = 'flex';
      } else {
        // Show server-side validation errors
        if (result.errors) {
          Object.keys(result.errors).forEach(field => {
            showError(field, result.errors[field]);
          });
        } else {
          alert(result.error || 'An error occurred. Please try again.');
        }
      }
    } catch (error) {
      console.error('Form submission error:', error);
      alert('There was an error sending your message. Please try again or contact us directly at support@packaxis.ca');
    } finally {
      submitBtn.classList.remove('loading');
      submitBtn.disabled = false;
    }
  });
});

function resetContactForm() {
  const form = document.getElementById('contact-form');
  const successMsg = document.getElementById('contact-success');
  form.reset();
  form.style.display = 'block';
  successMsg.style.display = 'none';
}
</script>
{% endblock %}
